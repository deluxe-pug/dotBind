language: node_js
node_js:
- 4.2.4
env:
  matrix:
  - TEST_DIR=server/api
  - TEST_DIR=server/static
  global:
  - LOAD_SAMPLE=true
  - CXX=g++-4.8
  - secure: jeL6Ghg8zY/XFM6X76EEecEQGcACUI0iBXRNdi9T3UZG46rgSX+tOl0ptJGgOMX/UAwSXYB10yq3Tokr8Gq3t4avgtFjl1cKrkLAcaHzcIH8bGxMKe057chLcIlWn61LLO7afOK3KVBjcNUz94/Mb8H7lgZX7brUychg8fUjft+2TvXg41tRLDH6XOWxuNMcUWk4i6hV2slXtWEjPcsOcMtdYvowH1E1kEdkoD8bgY9qqQkdY+PjYyL/5L9ND7/Slr9zHcIZ0Sly3uKhMaZ2xVNBgFdhao0hxmY0tmpL0TptbE1/6fnPHru5lUWYK4CoiIYmRi3HJeexqd1gT+ob46NpHHZ4JBcRczekPznQJlm6NG9N+AfL0rQuexWkOEvNlXuVsThYoBrwHzTUHDJORshSHR7z2AIy41OoOidHGy7GwtGY88bCzgSHfuYxUGDv+CsB7EwnXLyz+5i3ljATzJ/SErMl7xOY8EfosDqD99Y8iudL0OdLUx05GPiDSguZC4fKeRzyva+vYPcGsKbKZe66sx9NjBgzdEzPJvtsyryHXf/fKqPxlpmN1TwWPVHgW0HpD5wj3WY6bzMBPd9VWB+Zb4rEdejKUrLnyX1ay0xSjhpgPRt40l0ByCtsy4BRNNRXoKt5dpqkgw2YsSKv/HSobKKb4B3EsXgbYFklTFU=
  - secure: VVjwcivLC3GJM9HXPivb5jOxuTUr2qTMlBPWnGI3gUJESh5Qwy13J7bwovbJN5cSbVBp409O2cmkU3CaFVBDtFjlvysRRrMnyFLRCVhZaKE5hC3V9DNSl9uWYVPf5rvb/QNGdfmRdeZEyKOvQ4Nrpdf6akeFCiyKeLhDmZtnP5O8M3MvtxcK7bGz4Q10JBOZ/2R6ABAzFPLExglnzPdxEQ6GoMUt8JJnu3UFaxFqKZk3kM9Ft0DqiTKnMkev58R4P8n6iVpNHkHRwb0JIBXVoTzSrwavdV/Uz5J4fhRwG46LyrlkWSDxTo76sYo0vy/cBnoCgCkIxAdwBS2axptyNNc/o3UkJNdH2TXd9q+ts6iOafF8xGaRioNFMK5ZrASSHQfYSNXZt4nrxJHbVqsy3bMpTrWluBrGrtYgqu2RtQWHIQGWAp2TECyBxXaMzpw6uclBNaGJTybknQTODJJFdPPirm2SD8rUdC0ELsRPgVb1Kihn+mhwdkh1FIIJt0UUAICSAhI7ENUWKdd79gjtrxeQ4HnK4rggVjdJE1mlaBOkZVOUPs9d3JVnIE507Efzr94idO8jgem0o6M9V9uWk1S4x9WJR0D0HOXUDCgc1/BqRrU0P7AMAA8vhi0oVIOi2+HUyiEhqz3f1VWJU54iXIYLUTA+w/FQ/0y1L9JwBl4=
  - secure: hLhTgiuEEChh0Cko/OK0uZHzTmyVJ+snOvoXHn7E3qRqjXAW1WZP1V7UUbA3SrnS6ljKE+dN217Jt/hI4Wppemn02gVtFraBvNLZOdYSOS65kYRBj/0pt7+Crg46x5K28Vsq3VYi5u6HqLpf9ZQvt2iZF238lxyVJ0voFxLBWI0f6Ihd+DB+q0ceQWRM2qNJMq2f2Oc8q0RTukuex67DmSDN1gluIhElMr0nmymN07vdalNyNnq+s7yazlvbfDC6ER7HS5eLqL5h2eoWW5kpmzcJTFmETHj7QkHjyLjAzg595iCTVVcTh6PWmC2ZBnlr5tMMI/9yA9cqcUZ6FgFz162/6MwpvhZ1PuTFeFIvSMkHgjruSY6TkO+SrCi7+AlyU9gsaecXCDotdUt1GqYguswISjR8PyRcWrDW5oeDiPKxV2+o1pQEH/H4sAkZVemy/NitZHvWi7fmGdkvPmDRCmkBjpO6Fl3hHlncpzXjNQbsXESzOklD2O2q9V8TuMJgwc+lrV6PCWFxRupMYEcMchJ92EIK8DSKM81Pz5/AGc/ci6EvPas0u14Ia1/rWL1HhnNMv2/sQ0ls5hwKkVQD3xNxGN8b/J7cOB9iIzpHHUm0k+wpIyOh1iv9MM04n6KI17lvJNuocpChoHJlqYS482HkHB6ksb27FOjVga0UZ/c=
  - secure: tnbkZwVSl6odWc/D2b/kNex5NtcGN6lefApT9ZXZcpHm9UtYoGqti5C+03kUrSEQGEPn11NbF8kKMOBr7pVXa+PXT3iNxjXX8c7lLQMy0RvN/OPnYWYi12PGkb8d1izSdBVMxUKmv3w9hV3yLhvTcOvGfKofgyR3D0QxlscoqC94wX5ZVruYzEgVnUe0dLAguNkoX1CQjGRFMrteoeNi+FBobyqkPVRWvwi/6DneP1eorIcZkCNDdg6QDvh53LB2trayYDXDFNkelRYNvGI+7dncoRtpwN4oaPdEGbzIxu2Rxshw3k4qsztZJJS1Wd6QP7TUuN19awFMuBgZvgsVc5loc+ilIF+kjs8xtzJwVX8DguVGOG8d/DfVGXWGf+E91Zo7ljVn2SX4E0yiv4Cjd35y2A+vgS61UvfPWxWpnfq+aSWZ9UHk1kdU5BQx8P1K6FA0LDuUpuy3t+0SfLSYRt/e9OPUY9i2ZHAdZjLeP8QXB1YDqYM/kJz5COZHuKGQT8TSu5cJlLdWuiFBtynbBJBv4JmsvYGFcXPYLhA8OVW+4rBCLLLrD/RxsccUpdyovxszRcZa5l+Im8ka9c6oRjs6sGI8UVp/G0UKydQcBssNjM6giHrkheFsnlqAdc4r+pRJMl9fDabLVD58hnNGF30SUy4fTw5+rBNTAVEsj08=
addons:
  apt:
    sources:
    - ubuntu-toolchain-r-test
    packages:
    - gcc-4.8
    - g++-4.8
  postgresql: '9.3'
before_script:
- psql -c 'create database api_test;' -U postgres
script: cd $TEST_DIR && npm install && npm test
